{"version":3,"sources":["webpack:///./src/pages/404.tsx"],"names":["APP_PATHS","Page404","location","React","shouldRender","setShouldRender","some","path","pathname","startsWith","withPrefix","currentOriginWithPrefix","URL","origin","href","currentPathWithoutPrefix","replace","redirectURL","console","log","withPrefixSlash","window"],"mappings":"6FAAA,uFAKMA,EAAY,CAChB,SACA,UACA,kBACA,aACA,UACA,aACA,QACA,WACA,YAGa,SAASC,EAAT,GAA0C,IAAvBC,EAAuB,EAAvBA,SAAuB,EAIfC,YAAe,GAAhDC,EAJgD,KAIlCC,EAJkC,KAmCvD,OA7BAF,aAAgB,WACd,GACEH,EAAUM,MAAK,SAACC,GAAD,OAAUL,EAASM,SAASC,WAAWC,YAAWH,OACjE,CACA,IAAMI,EAA0B,IAAIC,IAAIF,YAAW,IAAKR,EAASW,QAC9DC,KACGC,EAA2Bb,EAASY,KAAKE,QAC7CL,EACA,IAIIM,EAAc,IAAIL,IAAIG,EA/Bf,qCA+BqDD,KAWlE,OATAI,QAAQC,IAAI,CACVR,0BACAI,2BACAE,cACAP,WAAYA,YAAW,IACvBU,gBAAiBV,YAAW,YAG9BW,OAAOnB,SAASY,KAAOG,GAIzBZ,GAAgB,KACf,IAECD,EACK,gBAAC,IAAD,MAGF","file":"component---src-pages-404-tsx-4e5e16cb011dee641dcf.js","sourcesContent":["import * as React from \"react\";\nimport { PageProps, withPrefix } from \"gatsby\";\nimport { NotFound } from \"../components/pages\";\n\nconst APP_ORIGIN = \"https://trackdechets.beta.gouv.fr\";\nconst APP_PATHS = [\n  \"/login\",\n  \"/signup\",\n  \"/reset-password\",\n  \"/wasteTree\",\n  \"/invite\",\n  \"/dashboard\",\n  \"/form\",\n  \"/account\",\n  \"/company\",\n];\n\nexport default function Page404({ location }: PageProps) {\n  // we keep the page blank on page load to avoid flashing a 404 page\n  // when the user actually needs to be redirected\n  // if the user doesn't have to be redirected, the page 404 is shown\n  const [shouldRender, setShouldRender] = React.useState(false);\n\n  React.useEffect(() => {\n    if (\n      APP_PATHS.some((path) => location.pathname.startsWith(withPrefix(path)))\n    ) {\n      const currentOriginWithPrefix = new URL(withPrefix(\"\"), location.origin)\n        .href;\n      const currentPathWithoutPrefix = location.href.replace(\n        currentOriginWithPrefix,\n        \"\"\n      );\n\n      // redirect to the application by preserving the path (query parameters and hash included)\n      const redirectURL = new URL(currentPathWithoutPrefix, APP_ORIGIN).href;\n\n      console.log({\n        currentOriginWithPrefix,\n        currentPathWithoutPrefix,\n        redirectURL,\n        withPrefix: withPrefix(\"\"),\n        withPrefixSlash: withPrefix(\"/\"),\n      });\n\n      window.location.href = redirectURL;\n      return;\n    }\n\n    setShouldRender(true);\n  }, []);\n\n  if (shouldRender) {\n    return <NotFound />;\n  }\n\n  return null;\n}\n"],"sourceRoot":""}